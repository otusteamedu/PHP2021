# PHP2021


##hw-1
Работа с окружением

Цель:
Познакомиться с различными типами организации окружения. Осознать их применимость и необходимость. 
Научиться настраивать рабочее окружение для своих проектов с использованием автоматизации.

Docker

Установить Docker себе на локальную машину
Описать инфраструктуру в Docker-compose, которая включает в себя
2.1. nginx (обрабатывает статику, пробрасывает выполнение скриптов в fpm)

2.2. php-fpm (соединяется с nginx через unix-сокет)

2.3. redis (соединяется с php по порту)

2.4. memcached (соединяется с php по порту)

БД подключать как отдельную VM (можно на базе Homestead), либо как контейнер (но тогда не забудьте про директории с 
данными)
Виртуальные машины.

Развернуть Homestead VM при помощи Vagrant и VirtualBox
Сайт должен отвечать на доменное имя application.local
Должна быть поддержка проброса директорий
Критерии оценки:
Каждый RUN в Dockerfile будет создавать промежуточный образ при сборке. Помните об этом. Желательно снизить их 
использование до минимума.

Docker - 5 баллов
Виртуалки - 5 баллов


##hw-2
Bash

Цель:
Научиться писать bash-скрипты для решения повседневных задач

Написать консольное приложение (bash-скрипт), который принимает два числа и выводит их сумму в стандартный вывод. 
Например
./sum.sh 1.5 -7

Если предоставлены неверные аргументы (для проверки на число можно использовать регулярное выражение) вывести ошибку в 
консоль.

Если Вы запускаете скрипты на базе Docker под Windows 10, то поведение функции sort по умолчанию отличается от 
стандартного в linux (числа сортируются как числа, а не как строки)

Имеется таблица следующего вида:
id user city phone 1 test Moscow 1234123 2 test2 Saint-P 1232121 3 test3 Tver 4352124 4 test4 Milan 7990923 5 test5 
Moscow 908213

Таблица хранится в текстовом файле.

Вывести на экран 3 наиболее популярных города среди пользователей системы, используя утилиты Линукса.

Подсказка: рекомендуется использовать утилиты uniq, awk, sort, head.

Критерии оценки:
Числа для суммирования могут быть отрицательными и вещественными.
Пакет bc для дистрибутивов Linux не является пакетом по умолчанию. Либо предусмотрите момент, когда пакет не установлен,
либо решите проблему при помощи других средств.
Калькулятор - 5 баллов Сортировщик - 5 баллов


##hw-3
Работа с пакетами

Цель:
Научиться создавать свои пакеты и подключать их как Composer-зависимости

Необходимо создать свой пакет.

В pull-request прислать composer.json, в котором приводится пример подключения Вашего пакета.

Критерии оценки:
Пакет должен ставиться при помощи

composer require package-name

Пакет должен отвечать PSR-4 Пакет может подключаться в Composer либо с packagist, либо из GitHub

4 балла за соответствие PSR-4 3 балла успешное подключение к пакету 3 балла за корректность содержимого пакета


##hw-4
Браузерное и консольное приложения

Цель:
Учимся писать приложения. До того, как изучить принципы написания хорошего ПО, нужно прочувствовать, где и какие есть 
пробелы в знаниях. Заодно - научиться работать с новыми для себя технологиями.

Верификация строки со скобками Используя Docker, вы описали сборку двух контейнеров – один с nginx, второй – с php-fpm и
вашим кодом. Используя docker-compose вы запускаете оба контейнера. Контейнер с nginx пробрасывает 80 порт на вашу 
хостовую машину и ожидает соединений. Клиент соединяется, и шлёт следующий HTTP-запрос:
POST / HTTP/1.1

string=(()()()()))((((()()()))(()()()(((()))))))

String - это POST-параметр, который можно проверять:

1.1. На непустоту 1.2. На корректность кол-ва открытых и закрытых скобок

Все запросы с динамическим содержимым (*.php) nginx, используя директиву fastcgi_pass, проксирует в контейнер с php-fpm 
и вашим кодом. Nginx должен обрабатывать запросы не обращая внимания на директиву Host. После обработки, • если строка 
корректна, то пользователю возвращается ответ 200 OK, с информационным текстом, что всё хорошо; • если строка 
некорректна, то пользователю возвращается ответ 400 Bad Request, с информационным текстом, что всё плохо.

Консольный чат на сокетах Создать логику, размещаемую в двух php-контейнерах (server и client), объединённых общим 
volume. Скрипты запускаются в режиме прослушивания STDIN и обмениваются друг с другом вводимыми сообщениями через 
unix-сокеты.
Критерии оценки:
Валидатор - 5 баллов Чат - 5 баллов

Строка в примере - только пример. На тестах она должна быть любой

Соответствие скобок должно быть и с точки зрения скобок. Тест ")(" не должен проходить

Конструкции @ и die неприемлемы. Вместо них используйте исключения

С точки зрения логики веб-сервиса ответ 400 - это валидное завершение работы скрипта

В рамках одной машины (без сетевого соединения) сборка LNMP гораздо быстрее работает при соединении FPM и Nginx через 
socket. Плюс за использование именно такой настройки.

Принимается только Unix-сокет

Код здесь и далее мы пишем с применением ООП

Код здесь и далее должен быть конфигурируем через файлы настроек типа config.ini

Обратите внимание на паттерн FrontController (он же - единая точка доступа). Все приложения, которые Вы создаёте здесь и
далее должны вызываться через один файл index.php, в котором есть ТОЛЬКО

Точка входа - app.php

Сервер и клиент запускаются командами

php app.php server php app.php client

В app.php только строки
require_once('/path/to/composer/autoload.php');

try { $app = new App(); $app->run(); } catch(Exception $e){ }

Логика чтения конфигураций и работы с сокетами - только в классах.


##hw-5

